Soient :
A.Kpub la clé publique d'alice
B.Kpriv la clé privée de Bob
C.rib la relevé d'identité banquaire de Charlie
D.facture une facture emise pas Dominique
E.paiement l'ordre de paiement venant d'Eve
S(X.rib, Y.Kpub) le rib de Xavier signé par Yoann
C(F.rib, F.Kpriv) le rib de Frederic chiffré avec la clé privée de Frederic

Il faut que :
le vendeur puisse authentifier le client
le client puisse authentifier le vendeur
le client ne puisse nier le paiement
le bandit ne puisse pas se faire passer pour le client
le bandit ne puisse pas se faire passer pour le vendeur

Banque connais :
banque.Kpub
banque.kpriv
vendeur.rib
client.rib

Vendeur connais :
banque.Kpub
vendeur.rib
S(vendeur.rib, banque.Kpriv)
vendeur.Kpub
vendeur.Kpriv

Client connais : 
banque.Kpub
client.rib
S(client.rib, banque.Kpriv)
client.Kpub
client.Kpriv


établissement de la facture :
vendeur.facture + C(vendeur.rib, client.Kpub) + S(vendeur.rib+vendeur.Kpub, Banque.Kpriv) + S(vendeur.Kpriv)

établissement de l'ordre de paiement :
client.paiement + C(client.rib, vendeur.Kpub) + S(client.rib+client.Kpub, banque.Kpriv) + vendeur.facture + S(client.Kpriv)


Eve veut intercepter le paiement de Alice pour Bob : impossible sans activer l'alarme
Bob veut payer Eve pour une facture virtuelle : PEBKAC!!!
Eve veut payer Alice avec le rib de Bob : impossible sans activer l'alarme
